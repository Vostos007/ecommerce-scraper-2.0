# Deployment (Docker)

## 1) Подготовка
```bash
# Перейдите в корень репозитория и поместите эти файлы:
#  - Dockerfile.backend
#  - Dockerfile.dashboard
#  - docker-compose.yml
#  - .env.example
#  - Makefile

cp .env.example .env
```

## 2) Первый запуск
```bash
make up
# откройте http://localhost:3000 (Dashboard)
# API доступно на http://localhost:8000
```

## 3) Обновления (рекомендуемый вариант)
```bash
make update   # внутри: git pull + docker compose build --pull + up -d
```

> Не делайте `git pull` **внутри** контейнеров. Обновляем образы извне через compose.

## 4) Альтернатива (registry + watchtower)
- Собирать образы в CI и пушить в registry.
- На сервере: `docker compose pull && docker compose up -d`.
- Для автопулла добавьте контейнер `watchtower` (см. закомментированный блок в compose).

## 5) Полезные команды
```bash
make logs   # логи всех сервисов
make ps     # статус контейнеров
make down   # остановить
make clean  # остановить и удалить тома
```

## 6) Примечания
- FlareSolverr доступен на `http://localhost:8192`.
- MinIO: API `http://localhost:9000`, Console `http://localhost:9001` (логин/пароль из .env).
- Если Dashboard не видит API — проверьте `NEXT_PUBLIC_API_BASE_URL` и CORS.
